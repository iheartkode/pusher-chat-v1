<h1>Chat Room</h1>

<div class="container conversation">
  <ul id="body-container">
    <% @messages.each do |message| %>
    <div class="messages container">
      <p id="body"> <%= message.body %></p><br />
    </div>
    <% end %>
  </ul>

  <%= form_for @message, remote: true do |f| %>
  <div class="field">
    <%= f.label :body %><br />
    <%= f.text_area :body, :class => 'text-field' %>
  </div>
  <div class="actions">
    <%= f.submit 'Send', :class => 'btn btn-primary' %>
  </div>
  <% end %>
</div>
<script>
var pusher = new Pusher('42b5fd3755f8e9edc491');
var channel = pusher.subscribe('my-channel');

  channel.bind('my-event', function(data) {


    $('.text-field').val('');
    $('#body-container').prepend('<%= escape_javascript(render 'message') %>');
    $('#body').first().html(data.message);

  });

</script>
